"""add TF-IDF keyword extraction system

Revision ID: 036_tfidf_keywords
Revises: 035_org_quality_config
Create Date: 2025-12-05 00:00:00

Add TF-IDF keyword extraction with hybrid global/user corpus statistics,
ML feedback tracking, and entity-to-keyword conversion
"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects.postgresql import JSONB, UUID

# revision identifiers, used by Alembic.
revision = '036_tfidf_keywords'
down_revision = '035_org_quality_config'
branch_labels = None
depends_on = None


def upgrade():
    # 1. Create keyword_extraction_config table
    op.create_table(
        'keyword_extraction_config',
        sa.Column('id', sa.Integer, primary_key=True, autoincrement=True),
        sa.Column('config_key', sa.String(100), nullable=False, unique=True, index=True),
        sa.Column('config_value', sa.Float, nullable=False),
        sa.Column('category', sa.String(50), nullable=False),
        sa.Column('description', sa.Text),
        sa.Column('min_value', sa.Float),
        sa.Column('max_value', sa.Float),
        sa.Column('created_at', sa.DateTime, server_default=sa.func.now()),
        sa.Column('updated_at', sa.DateTime, server_default=sa.func.now(), onupdate=sa.func.now())
    )

    # 2. Create global_corpus_stats table (shared IDF across all users)
    op.create_table(
        'global_corpus_stats',
        sa.Column('id', sa.Integer, primary_key=True, autoincrement=True),
        sa.Column('word', sa.String(100), nullable=False),
        sa.Column('language', sa.String(10), nullable=False),
        sa.Column('document_count', sa.Integer, nullable=False, default=0),
        sa.Column('total_documents', sa.Integer, nullable=False, default=0),
        sa.Column('last_updated', sa.DateTime, server_default=sa.func.now(), onupdate=sa.func.now()),
        sa.UniqueConstraint('word', 'language', name='uq_global_corpus_word_lang')
    )
    op.create_index('idx_global_corpus_word_lang', 'global_corpus_stats', ['word', 'language'])

    # 3. Create user_corpus_stats table (personal IDF per user)
    op.create_table(
        'user_corpus_stats',
        sa.Column('id', sa.Integer, primary_key=True, autoincrement=True),
        sa.Column('user_id', UUID(as_uuid=True), sa.ForeignKey('users.id', ondelete='CASCADE'), nullable=False),
        sa.Column('word', sa.String(100), nullable=False),
        sa.Column('language', sa.String(10), nullable=False),
        sa.Column('document_count', sa.Integer, nullable=False, default=0),
        sa.Column('total_documents', sa.Integer, nullable=False, default=0),
        sa.Column('last_updated', sa.DateTime, server_default=sa.func.now(), onupdate=sa.func.now()),
        sa.UniqueConstraint('user_id', 'word', 'language', name='uq_user_corpus_word_lang')
    )
    op.create_index('idx_user_corpus_user_word_lang', 'user_corpus_stats', ['user_id', 'word', 'language'])

    # 4. Create keyword_training_data table (ML feedback)
    op.create_table(
        'keyword_training_data',
        sa.Column('id', sa.Integer, primary_key=True, autoincrement=True),
        sa.Column('user_id', UUID(as_uuid=True), sa.ForeignKey('users.id', ondelete='CASCADE'), nullable=False),
        sa.Column('keyword', sa.String(100), nullable=False),
        sa.Column('language', sa.String(10), nullable=False),
        sa.Column('category_id', UUID(as_uuid=True), sa.ForeignKey('categories.id', ondelete='CASCADE'), nullable=True),
        sa.Column('feedback_type', sa.String(20), nullable=False),  # 'kept', 'removed', 'added'
        sa.Column('original_relevance', sa.Float),
        sa.Column('context', JSONB, default={}),
        sa.Column('created_at', sa.DateTime, server_default=sa.func.now()),
        sa.Column('updated_at', sa.DateTime, server_default=sa.func.now(), onupdate=sa.func.now())
    )
    op.create_index('idx_training_user_keyword', 'keyword_training_data', ['user_id', 'keyword', 'language'])

    # 5. Add TF-IDF configuration values
    op.execute("""
        INSERT INTO keyword_extraction_config (config_key, config_value, category, description, min_value, max_value)
        VALUES
        -- TF-IDF feature flags
        ('tfidf_enabled', 1.0, 'feature', 'Enable TF-IDF scoring (1.0=on, 0.0=off)', 0.0, 1.0),
        ('tfidf_smoothing', 1.0, 'algorithm', 'IDF smoothing constant (add to document counts)', 0.5, 2.0),

        -- Hybrid blending (global vs user corpus)
        ('ml_blend_alpha_initial', 0.7, 'algorithm', 'Initial weight for global corpus (decays with user doc count)', 0.5, 0.9),
        ('ml_blend_alpha_decay', 0.01, 'algorithm', 'Alpha decay rate per user document', 0.005, 0.02),
        ('ml_blend_alpha_min', 0.3, 'algorithm', 'Minimum alpha (always keep some global influence)', 0.1, 0.5),

        -- Entity-to-keyword conversion thresholds
        ('org_to_keyword_min_confidence', 0.50, 'threshold', 'Min confidence to convert rejected ORG to keyword', 0.3, 0.75),
        ('org_to_keyword_max_confidence', 0.85, 'threshold', 'Max confidence for ORG rejection (above this = keep as entity)', 0.75, 0.95),
        ('person_to_keyword_enabled', 0.0, 'feature', 'Enable PERSON→keyword conversion (disabled by default)', 0.0, 1.0),
        ('location_to_keyword_enabled', 0.0, 'feature', 'Enable LOCATION→keyword conversion (disabled by default)', 0.0, 1.0),

        -- ML feedback learning rates
        ('ml_feedback_learning_rate', 0.15, 'algorithm', 'Learning rate for user feedback adjustments', 0.05, 0.3),
        ('ml_min_feedback_samples', 3.0, 'threshold', 'Min feedback samples before applying ML adjustments', 2.0, 10.0),

        -- Privacy safeguards
        ('global_ml_min_users', 5.0, 'privacy', 'Min users required before contributing to global corpus', 3.0, 10.0),
        ('global_ml_opt_out_default', 0.0, 'privacy', 'Default opt-out status (0.0=opted in, 1.0=opted out)', 0.0, 1.0)
    """)

    # 6. Populate global_corpus_stats with seed data (200 words per language)
    # These are common content words (NOT stop words) that should get low IDF scores
    # Based on Leipzig Corpora, Google Books Ngrams, and other frequency dictionaries

    op.execute("""
        INSERT INTO global_corpus_stats (word, language, document_count, total_documents)
        VALUES
        -- German (de) - 200 most common content words
        -- Common verbs
        ('können', 'de', 850, 1000),
        ('sagen', 'de', 840, 1000),
        ('machen', 'de', 830, 1000),
        ('geben', 'de', 820, 1000),
        ('kommen', 'de', 810, 1000),
        ('sollen', 'de', 800, 1000),
        ('wollen', 'de', 790, 1000),
        ('gehen', 'de', 780, 1000),
        ('wissen', 'de', 770, 1000),
        ('sehen', 'de', 760, 1000),
        ('lassen', 'de', 750, 1000),
        ('stehen', 'de', 740, 1000),
        ('finden', 'de', 730, 1000),
        ('bleiben', 'de', 720, 1000),
        ('liegen', 'de', 710, 1000),
        ('heißen', 'de', 700, 1000),
        ('denken', 'de', 690, 1000),
        ('nehmen', 'de', 680, 1000),
        ('tun', 'de', 670, 1000),
        ('dürfen', 'de', 660, 1000),
        ('glauben', 'de', 650, 1000),
        ('halten', 'de', 640, 1000),
        ('nennen', 'de', 630, 1000),
        ('mögen', 'de', 620, 1000),
        ('zeigen', 'de', 610, 1000),
        ('führen', 'de', 600, 1000),
        ('sprechen', 'de', 590, 1000),
        ('bringen', 'de', 580, 1000),
        ('leben', 'de', 570, 1000),
        ('fahren', 'de', 560, 1000),
        ('meinen', 'de', 550, 1000),
        ('fragen', 'de', 540, 1000),
        ('kennen', 'de', 530, 1000),
        ('gelten', 'de', 520, 1000),
        ('stellen', 'de', 510, 1000),
        ('spielen', 'de', 500, 1000),
        ('arbeiten', 'de', 490, 1000),
        ('brauchen', 'de', 480, 1000),
        ('folgen', 'de', 470, 1000),
        ('lernen', 'de', 460, 1000),
        ('bestehen', 'de', 450, 1000),
        ('verstehen', 'de', 440, 1000),
        ('setzen', 'de', 430, 1000),
        ('bekommen', 'de', 420, 1000),
        ('beginnen', 'de', 410, 1000),
        ('erzählen', 'de', 400, 1000),
        ('versuchen', 'de', 390, 1000),
        ('schreiben', 'de', 380, 1000),
        ('laufen', 'de', 370, 1000),
        ('bilden', 'de', 360, 1000),

        -- Common nouns
        ('jahr', 'de', 850, 1000),
        ('zeit', 'de', 840, 1000),
        ('mensch', 'de', 830, 1000),
        ('tag', 'de', 820, 1000),
        ('mann', 'de', 810, 1000),
        ('frau', 'de', 800, 1000),
        ('kind', 'de', 790, 1000),
        ('land', 'de', 780, 1000),
        ('stadt', 'de', 770, 1000),
        ('auge', 'de', 760, 1000),
        ('hand', 'de', 750, 1000),
        ('haus', 'de', 740, 1000),
        ('welt', 'de', 730, 1000),
        ('leben', 'de', 720, 1000),
        ('seite', 'de', 710, 1000),
        ('fall', 'de', 700, 1000),
        ('weg', 'de', 690, 1000),
        ('arbeit', 'de', 680, 1000),
        ('stelle', 'de', 670, 1000),
        ('punkt', 'de', 660, 1000),
        ('frage', 'de', 650, 1000),
        ('recht', 'de', 640, 1000),
        ('kraft', 'de', 630, 1000),
        ('wort', 'de', 620, 1000),
        ('name', 'de', 610, 1000),
        ('form', 'de', 600, 1000),
        ('ende', 'de', 590, 1000),
        ('raum', 'de', 580, 1000),
        ('platz', 'de', 570, 1000),
        ('gruppe', 'de', 560, 1000),
        ('stunde', 'de', 550, 1000),
        ('gegend', 'de', 540, 1000),
        ('herr', 'de', 530, 1000),
        ('grund', 'de', 520, 1000),
        ('anfang', 'de', 510, 1000),
        ('blick', 'de', 500, 1000),
        ('sache', 'de', 490, 1000),
        ('wesen', 'de', 480, 1000),
        ('teil', 'de', 470, 1000),
        ('lage', 'de', 460, 1000),
        ('interesse', 'de', 450, 1000),
        ('stelle', 'de', 440, 1000),
        ('zweck', 'de', 430, 1000),
        ('staat', 'de', 420, 1000),
        ('volk', 'de', 410, 1000),
        ('bild', 'de', 400, 1000),
        ('zahl', 'de', 390, 1000),
        ('ding', 'de', 380, 1000),
        ('gedanke', 'de', 370, 1000),
        ('geschichte', 'de', 360, 1000),

        -- Common adjectives
        ('groß', 'de', 800, 1000),
        ('neu', 'de', 790, 1000),
        ('gut', 'de', 780, 1000),
        ('hoch', 'de', 770, 1000),
        ('lang', 'de', 760, 1000),
        ('deutsch', 'de', 750, 1000),
        ('eigen', 'de', 740, 1000),
        ('wenig', 'de', 730, 1000),
        ('ganz', 'de', 720, 1000),
        ('stark', 'de', 710, 1000),
        ('jung', 'de', 700, 1000),
        ('alt', 'de', 690, 1000),
        ('weit', 'de', 680, 1000),
        ('wichtig', 'de', 670, 1000),
        ('klein', 'de', 660, 1000),
        ('möglich', 'de', 650, 1000),
        ('spät', 'de', 640, 1000),
        ('politisch', 'de', 630, 1000),
        ('frei', 'de', 620, 1000),
        ('kurz', 'de', 610, 1000),
        ('bestimmt', 'de', 600, 1000),
        ('schwer', 'de', 590, 1000),
        ('ähnlich', 'de', 580, 1000),
        ('besonder', 'de', 570, 1000),
        ('richtig', 'de', 560, 1000),
        ('gleich', 'de', 550, 1000),
        ('einzeln', 'de', 540, 1000),
        ('klar', 'de', 530, 1000),
        ('verschieden', 'de', 520, 1000),
        ('einfach', 'de', 510, 1000),
        ('nah', 'de', 500, 1000),
        ('allgemein', 'de', 490, 1000),
        ('gesellschaftlich', 'de', 480, 1000),
        ('fest', 'de', 470, 1000),
        ('wahr', 'de', 460, 1000),
        ('bedeutend', 'de', 450, 1000),
        ('öffentlich', 'de', 440, 1000),
        ('wirtschaftlich', 'de', 430, 1000),
        ('schwarz', 'de', 420, 1000),
        ('tief', 'de', 410, 1000),
        ('tot', 'de', 400, 1000),
        ('schön', 'de', 390, 1000),
        ('weiß', 'de', 380, 1000),
        ('breit', 'de', 370, 1000),
        ('dunkel', 'de', 360, 1000),
        ('eng', 'de', 350, 1000),
        ('schlecht', 'de', 340, 1000),
        ('voll', 'de', 330, 1000),
        ('schnell', 'de', 320, 1000),
        ('hell', 'de', 310, 1000),

        -- Common adverbs
        ('sehr', 'de', 850, 1000),
        ('noch', 'de', 840, 1000),
        ('mehr', 'de', 830, 1000),
        ('schon', 'de', 820, 1000),
        ('jetzt', 'de', 810, 1000),
        ('heute', 'de', 800, 1000),
        ('hier', 'de', 790, 1000),
        ('immer', 'de', 780, 1000),
        ('wieder', 'de', 770, 1000),
        ('viel', 'de', 760, 1000),
        ('wohl', 'de', 750, 1000),
        ('doch', 'de', 740, 1000),
        ('eben', 'de', 730, 1000),
        ('vielleicht', 'de', 720, 1000),
        ('natürlich', 'de', 710, 1000),
        ('ebenso', 'de', 700, 1000),
        ('allerdings', 'de', 690, 1000),
        ('ebenfalls', 'de', 680, 1000),
        ('deshalb', 'de', 670, 1000),
        ('dennoch', 'de', 660, 1000),
        ('gleichzeitig', 'de', 650, 1000),
        ('außerdem', 'de', 640, 1000),
        ('trotzdem', 'de', 630, 1000),
        ('insbesondere', 'de', 620, 1000),
        ('besonders', 'de', 610, 1000),
        ('zugleich', 'de', 600, 1000),
        ('sozusagen', 'de', 590, 1000),
        ('offenbar', 'de', 580, 1000),
        ('tatsächlich', 'de', 570, 1000),
        ('freilich', 'de', 560, 1000),
        ('jedoch', 'de', 550, 1000),
        ('dagegen', 'de', 540, 1000),
        ('vielmehr', 'de', 530, 1000),
        ('überhaupt', 'de', 520, 1000),
        ('übrigens', 'de', 510, 1000),
        ('außer', 'de', 500, 1000),
        ('sonst', 'de', 490, 1000),
        ('weiter', 'de', 480, 1000),
        ('später', 'de', 470, 1000),
        ('früher', 'de', 460, 1000),
        ('bald', 'de', 450, 1000),
        ('sofort', 'de', 440, 1000),
        ('gleich', 'de', 430, 1000),
        ('direkt', 'de', 420, 1000),
        ('etwa', 'de', 410, 1000),
        ('fast', 'de', 400, 1000),
        ('kaum', 'de', 390, 1000),
        ('zudem', 'de', 380, 1000),
        ('durchaus', 'de', 370, 1000),
        ('ziemlich', 'de', 360, 1000),

        -- English (en) - 200 most common content words
        -- Common verbs
        ('make', 'en', 850, 1000),
        ('know', 'en', 840, 1000),
        ('get', 'en', 830, 1000),
        ('give', 'en', 820, 1000),
        ('think', 'en', 810, 1000),
        ('take', 'en', 800, 1000),
        ('come', 'en', 790, 1000),
        ('see', 'en', 780, 1000),
        ('want', 'en', 770, 1000),
        ('look', 'en', 760, 1000),
        ('use', 'en', 750, 1000),
        ('find', 'en', 740, 1000),
        ('tell', 'en', 730, 1000),
        ('ask', 'en', 720, 1000),
        ('work', 'en', 710, 1000),
        ('seem', 'en', 700, 1000),
        ('feel', 'en', 690, 1000),
        ('try', 'en', 680, 1000),
        ('leave', 'en', 670, 1000),
        ('call', 'en', 660, 1000),
        ('keep', 'en', 650, 1000),
        ('let', 'en', 640, 1000),
        ('begin', 'en', 630, 1000),
        ('help', 'en', 620, 1000),
        ('talk', 'en', 610, 1000),
        ('turn', 'en', 600, 1000),
        ('start', 'en', 590, 1000),
        ('show', 'en', 580, 1000),
        ('hear', 'en', 570, 1000),
        ('play', 'en', 560, 1000),
        ('run', 'en', 550, 1000),
        ('move', 'en', 540, 1000),
        ('live', 'en', 530, 1000),
        ('believe', 'en', 520, 1000),
        ('bring', 'en', 510, 1000),
        ('happen', 'en', 500, 1000),
        ('write', 'en', 490, 1000),
        ('provide', 'en', 480, 1000),
        ('sit', 'en', 470, 1000),
        ('stand', 'en', 460, 1000),
        ('lose', 'en', 450, 1000),
        ('pay', 'en', 440, 1000),
        ('meet', 'en', 430, 1000),
        ('include', 'en', 420, 1000),
        ('continue', 'en', 410, 1000),
        ('set', 'en', 400, 1000),
        ('learn', 'en', 390, 1000),
        ('change', 'en', 380, 1000),
        ('lead', 'en', 370, 1000),
        ('understand', 'en', 360, 1000),

        -- Common nouns
        ('time', 'en', 850, 1000),
        ('year', 'en', 840, 1000),
        ('people', 'en', 830, 1000),
        ('way', 'en', 820, 1000),
        ('day', 'en', 810, 1000),
        ('man', 'en', 800, 1000),
        ('thing', 'en', 790, 1000),
        ('woman', 'en', 780, 1000),
        ('life', 'en', 770, 1000),
        ('child', 'en', 760, 1000),
        ('world', 'en', 750, 1000),
        ('school', 'en', 740, 1000),
        ('state', 'en', 730, 1000),
        ('family', 'en', 720, 1000),
        ('student', 'en', 710, 1000),
        ('group', 'en', 700, 1000),
        ('country', 'en', 690, 1000),
        ('problem', 'en', 680, 1000),
        ('hand', 'en', 670, 1000),
        ('part', 'en', 660, 1000),
        ('place', 'en', 650, 1000),
        ('case', 'en', 640, 1000),
        ('week', 'en', 630, 1000),
        ('company', 'en', 620, 1000),
        ('system', 'en', 610, 1000),
        ('program', 'en', 600, 1000),
        ('question', 'en', 590, 1000),
        ('work', 'en', 580, 1000),
        ('government', 'en', 570, 1000),
        ('number', 'en', 560, 1000),
        ('night', 'en', 550, 1000),
        ('point', 'en', 540, 1000),
        ('home', 'en', 530, 1000),
        ('water', 'en', 520, 1000),
        ('room', 'en', 510, 1000),
        ('mother', 'en', 500, 1000),
        ('area', 'en', 490, 1000),
        ('money', 'en', 480, 1000),
        ('story', 'en', 470, 1000),
        ('fact', 'en', 460, 1000),
        ('month', 'en', 450, 1000),
        ('lot', 'en', 440, 1000),
        ('right', 'en', 430, 1000),
        ('study', 'en', 420, 1000),
        ('book', 'en', 410, 1000),
        ('eye', 'en', 400, 1000),
        ('job', 'en', 390, 1000),
        ('word', 'en', 380, 1000),
        ('business', 'en', 370, 1000),
        ('issue', 'en', 360, 1000),

        -- Common adjectives
        ('other', 'en', 850, 1000),
        ('new', 'en', 840, 1000),
        ('good', 'en', 830, 1000),
        ('high', 'en', 820, 1000),
        ('old', 'en', 810, 1000),
        ('great', 'en', 800, 1000),
        ('big', 'en', 790, 1000),
        ('american', 'en', 780, 1000),
        ('small', 'en', 770, 1000),
        ('large', 'en', 760, 1000),
        ('national', 'en', 750, 1000),
        ('young', 'en', 740, 1000),
        ('different', 'en', 730, 1000),
        ('black', 'en', 720, 1000),
        ('long', 'en', 710, 1000),
        ('little', 'en', 700, 1000),
        ('important', 'en', 690, 1000),
        ('political', 'en', 680, 1000),
        ('bad', 'en', 670, 1000),
        ('white', 'en', 660, 1000),
        ('real', 'en', 650, 1000),
        ('best', 'en', 640, 1000),
        ('right', 'en', 630, 1000),
        ('social', 'en', 620, 1000),
        ('only', 'en', 610, 1000),
        ('public', 'en', 600, 1000),
        ('sure', 'en', 590, 1000),
        ('low', 'en', 580, 1000),
        ('early', 'en', 570, 1000),
        ('able', 'en', 560, 1000),
        ('human', 'en', 550, 1000),
        ('local', 'en', 540, 1000),
        ('late', 'en', 530, 1000),
        ('hard', 'en', 520, 1000),
        ('major', 'en', 510, 1000),
        ('better', 'en', 500, 1000),
        ('economic', 'en', 490, 1000),
        ('strong', 'en', 480, 1000),
        ('possible', 'en', 470, 1000),
        ('whole', 'en', 460, 1000),
        ('free', 'en', 450, 1000),
        ('military', 'en', 440, 1000),
        ('true', 'en', 430, 1000),
        ('federal', 'en', 420, 1000),
        ('international', 'en', 410, 1000),
        ('full', 'en', 400, 1000),
        ('special', 'en', 390, 1000),
        ('easy', 'en', 380, 1000),
        ('clear', 'en', 370, 1000),
        ('recent', 'en', 360, 1000),

        -- Common adverbs
        ('very', 'en', 850, 1000),
        ('well', 'en', 840, 1000),
        ('just', 'en', 830, 1000),
        ('even', 'en', 820, 1000),
        ('also', 'en', 810, 1000),
        ('now', 'en', 800, 1000),
        ('back', 'en', 790, 1000),
        ('only', 'en', 780, 1000),
        ('still', 'en', 770, 1000),
        ('really', 'en', 760, 1000),
        ('then', 'en', 750, 1000),
        ('here', 'en', 740, 1000),
        ('quite', 'en', 730, 1000),
        ('perhaps', 'en', 720, 1000),
        ('never', 'en', 710, 1000),
        ('always', 'en', 700, 1000),
        ('already', 'en', 690, 1000),
        ('often', 'en', 680, 1000),
        ('usually', 'en', 670, 1000),
        ('sometimes', 'en', 660, 1000),
        ('especially', 'en', 650, 1000),
        ('particularly', 'en', 640, 1000),
        ('probably', 'en', 630, 1000),
        ('certainly', 'en', 620, 1000),
        ('actually', 'en', 610, 1000),
        ('however', 'en', 600, 1000),
        ('therefore', 'en', 590, 1000),
        ('indeed', 'en', 580, 1000),
        ('finally', 'en', 570, 1000),
        ('instead', 'en', 560, 1000),
        ('together', 'en', 550, 1000),
        ('almost', 'en', 540, 1000),
        ('enough', 'en', 530, 1000),
        ('completely', 'en', 520, 1000),
        ('exactly', 'en', 510, 1000),
        ('directly', 'en', 500, 1000),
        ('clearly', 'en', 490, 1000),
        ('simply', 'en', 480, 1000),
        ('recently', 'en', 470, 1000),
        ('immediately', 'en', 460, 1000),
        ('apparently', 'en', 450, 1000),
        ('obviously', 'en', 440, 1000),
        ('generally', 'en', 430, 1000),
        ('specifically', 'en', 420, 1000),
        ('essentially', 'en', 410, 1000),
        ('mainly', 'en', 400, 1000),
        ('largely', 'en', 390, 1000),
        ('relatively', 'en', 380, 1000),
        ('extremely', 'en', 370, 1000),
        ('highly', 'en', 360, 1000),

        -- French (fr) - 200 most common content words
        -- Common verbs
        ('faire', 'fr', 850, 1000),
        ('dire', 'fr', 840, 1000),
        ('aller', 'fr', 830, 1000),
        ('voir', 'fr', 820, 1000),
        ('savoir', 'fr', 810, 1000),
        ('pouvoir', 'fr', 800, 1000),
        ('falloir', 'fr', 790, 1000),
        ('vouloir', 'fr', 780, 1000),
        ('venir', 'fr', 770, 1000),
        ('devoir', 'fr', 760, 1000),
        ('prendre', 'fr', 750, 1000),
        ('trouver', 'fr', 740, 1000),
        ('donner', 'fr', 730, 1000),
        ('parler', 'fr', 720, 1000),
        ('aimer', 'fr', 710, 1000),
        ('passer', 'fr', 700, 1000),
        ('mettre', 'fr', 690, 1000),
        ('demander', 'fr', 680, 1000),
        ('tenir', 'fr', 670, 1000),
        ('sembler', 'fr', 660, 1000),
        ('laisser', 'fr', 650, 1000),
        ('rester', 'fr', 640, 1000),
        ('croire', 'fr', 630, 1000),
        ('sentir', 'fr', 620, 1000),
        ('porter', 'fr', 610, 1000),
        ('vivre', 'fr', 600, 1000),
        ('arriver', 'fr', 590, 1000),
        ('paraître', 'fr', 580, 1000),
        ('penser', 'fr', 570, 1000),
        ('rendre', 'fr', 560, 1000),
        ('devenir', 'fr', 550, 1000),
        ('regarder', 'fr', 540, 1000),
        ('entendre', 'fr', 530, 1000),
        ('comprendre', 'fr', 520, 1000),
        ('connaître', 'fr', 510, 1000),
        ('suivre', 'fr', 500, 1000),
        ('chercher', 'fr', 490, 1000),
        ('attendre', 'fr', 480, 1000),
        ('montrer', 'fr', 470, 1000),
        ('perdre', 'fr', 460, 1000),
        ('arrêter', 'fr', 450, 1000),
        ('servir', 'fr', 440, 1000),
        ('écrire', 'fr', 430, 1000),
        ('jouer', 'fr', 420, 1000),
        ('marcher', 'fr', 410, 1000),
        ('commencer', 'fr', 400, 1000),
        ('tomber', 'fr', 390, 1000),
        ('continuer', 'fr', 380, 1000),
        ('ouvrir', 'fr', 370, 1000),
        ('apprendre', 'fr', 360, 1000),

        -- Common nouns
        ('temps', 'fr', 850, 1000),
        ('année', 'fr', 840, 1000),
        ('jour', 'fr', 830, 1000),
        ('fois', 'fr', 820, 1000),
        ('homme', 'fr', 810, 1000),
        ('chose', 'fr', 800, 1000),
        ('vie', 'fr', 790, 1000),
        ('monde', 'fr', 780, 1000),
        ('main', 'fr', 770, 1000),
        ('enfant', 'fr', 760, 1000),
        ('yeux', 'fr', 750, 1000),
        ('femme', 'fr', 740, 1000),
        ('moment', 'fr', 730, 1000),
        ('heure', 'fr', 720, 1000),
        ('pays', 'fr', 710, 1000),
        ('tête', 'fr', 700, 1000),
        ('porte', 'fr', 690, 1000),
        ('ville', 'fr', 680, 1000),
        ('partie', 'fr', 670, 1000),
        ('maison', 'fr', 660, 1000),
        ('place', 'fr', 650, 1000),
        ('père', 'fr', 640, 1000),
        ('mère', 'fr', 630, 1000),
        ('question', 'fr', 620, 1000),
        ('côté', 'fr', 610, 1000),
        ('façon', 'fr', 600, 1000),
        ('cas', 'fr', 590, 1000),
        ('point', 'fr', 580, 1000),
        ('nom', 'fr', 570, 1000),
        ('travail', 'fr', 560, 1000),
        ('corps', 'fr', 550, 1000),
        ('voix', 'fr', 540, 1000),
        ('chambre', 'fr', 530, 1000),
        ('vue', 'fr', 520, 1000),
        ('mot', 'fr', 510, 1000),
        ('ami', 'fr', 500, 1000),
        ('bras', 'fr', 490, 1000),
        ('force', 'fr', 480, 1000),
        ('état', 'fr', 470, 1000),
        ('monsieur', 'fr', 460, 1000),
        ('famille', 'fr', 450, 1000),
        ('école', 'fr', 440, 1000),
        ('groupe', 'fr', 430, 1000),
        ('siècle', 'fr', 420, 1000),
        ('bout', 'fr', 410, 1000),
        ('raison', 'fr', 400, 1000),
        ('forme', 'fr', 390, 1000),
        ('gens', 'fr', 380, 1000),
        ('figure', 'fr', 370, 1000),
        ('mois', 'fr', 360, 1000),

        -- Common adjectives
        ('grand', 'fr', 850, 1000),
        ('petit', 'fr', 840, 1000),
        ('autre', 'fr', 830, 1000),
        ('nouveau', 'fr', 820, 1000),
        ('bon', 'fr', 810, 1000),
        ('vieux', 'fr', 800, 1000),
        ('jeune', 'fr', 790, 1000),
        ('dernier', 'fr', 780, 1000),
        ('premier', 'fr', 770, 1000),
        ('français', 'fr', 760, 1000),
        ('long', 'fr', 750, 1000),
        ('beau', 'fr', 740, 1000),
        ('seul', 'fr', 730, 1000),
        ('même', 'fr', 720, 1000),
        ('fort', 'fr', 710, 1000),
        ('blanc', 'fr', 700, 1000),
        ('noir', 'fr', 690, 1000),
        ('important', 'fr', 680, 1000),
        ('politique', 'fr', 670, 1000),
        ('public', 'fr', 660, 1000),
        ('ancien', 'fr', 650, 1000),
        ('haut', 'fr', 640, 1000),
        ('certain', 'fr', 630, 1000),
        ('tel', 'fr', 620, 1000),
        ('simple', 'fr', 610, 1000),
        ('différent', 'fr', 600, 1000),
        ('possible', 'fr', 590, 1000),
        ('vrai', 'fr', 580, 1000),
        ('difficile', 'fr', 570, 1000),
        ('libre', 'fr', 560, 1000),
        ('général', 'fr', 550, 1000),
        ('social', 'fr', 540, 1000),
        ('propre', 'fr', 530, 1000),
        ('national', 'fr', 520, 1000),
        ('humain', 'fr', 510, 1000),
        ('naturel', 'fr', 500, 1000),
        ('actuel', 'fr', 490, 1000),
        ('présent', 'fr', 480, 1000),
        ('européen', 'fr', 470, 1000),
        ('économique', 'fr', 460, 1000),
        ('international', 'fr', 450, 1000),
        ('militaire', 'fr', 440, 1000),
        ('meilleur', 'fr', 430, 1000),
        ('entier', 'fr', 420, 1000),
        ('civil', 'fr', 410, 1000),
        ('proche', 'fr', 400, 1000),
        ('faux', 'fr', 390, 1000),
        ('central', 'fr', 380, 1000),
        ('royal', 'fr', 370, 1000),
        ('capable', 'fr', 360, 1000),

        -- Common adverbs
        ('bien', 'fr', 850, 1000),
        ('plus', 'fr', 840, 1000),
        ('très', 'fr', 830, 1000),
        ('aussi', 'fr', 820, 1000),
        ('jamais', 'fr', 810, 1000),
        ('déjà', 'fr', 800, 1000),
        ('encore', 'fr', 790, 1000),
        ('toujours', 'fr', 780, 1000),
        ('alors', 'fr', 770, 1000),
        ('maintenant', 'fr', 760, 1000),
        ('souvent', 'fr', 750, 1000),
        ('moins', 'fr', 740, 1000),
        ('peut-être', 'fr', 730, 1000),
        ('ainsi', 'fr', 720, 1000),
        ('comment', 'fr', 710, 1000),
        ('ensuite', 'fr', 700, 1000),
        ('seulement', 'fr', 690, 1000),
        ('vraiment', 'fr', 680, 1000),
        ('assez', 'fr', 670, 1000),
        ('beaucoup', 'fr', 660, 1000),
        ('presque', 'fr', 650, 1000),
        ('enfin', 'fr', 640, 1000),
        ('ailleurs', 'fr', 630, 1000),
        ('parfois', 'fr', 620, 1000),
        ('plutôt', 'fr', 610, 1000),
        ('autant', 'fr', 600, 1000),
        ('pourtant', 'fr', 590, 1000),
        ('cependant', 'fr', 580, 1000),
        ('longtemps', 'fr', 570, 1000),
        ('davantage', 'fr', 560, 1000),
        ('simplement', 'fr', 550, 1000),
        ('particulièrement', 'fr', 540, 1000),
        ('également', 'fr', 530, 1000),
        ('naturellement', 'fr', 520, 1000),
        ('certainement', 'fr', 510, 1000),
        ('directement', 'fr', 500, 1000),
        ('évidemment', 'fr', 490, 1000),
        ('exactement', 'fr', 480, 1000),
        ('entièrement', 'fr', 470, 1000),
        ('complètement', 'fr', 460, 1000),
        ('absolument', 'fr', 450, 1000),
        ('totalement', 'fr', 440, 1000),
        ('notamment', 'fr', 430, 1000),
        ('généralement', 'fr', 420, 1000),
        ('spécialement', 'fr', 410, 1000),
        ('réellement', 'fr', 400, 1000),
        ('actuellement', 'fr', 390, 1000),
        ('essentiellement', 'fr', 380, 1000),
        ('rapidement', 'fr', 370, 1000),
        ('immédiatement', 'fr', 360, 1000),

        -- Russian (ru) - 200 most common content words
        -- Common verbs
        ('мочь', 'ru', 850, 1000),
        ('быть', 'ru', 840, 1000),
        ('сказать', 'ru', 830, 1000),
        ('говорить', 'ru', 820, 1000),
        ('знать', 'ru', 810, 1000),
        ('стать', 'ru', 800, 1000),
        ('видеть', 'ru', 790, 1000),
        ('хотеть', 'ru', 780, 1000),
        ('идти', 'ru', 770, 1000),
        ('понимать', 'ru', 760, 1000),
        ('сделать', 'ru', 750, 1000),
        ('делать', 'ru', 740, 1000),
        ('думать', 'ru', 730, 1000),
        ('дать', 'ru', 720, 1000),
        ('работать', 'ru', 710, 1000),
        ('жить', 'ru', 700, 1000),
        ('смотреть', 'ru', 690, 1000),
        ('найти', 'ru', 680, 1000),
        ('получить', 'ru', 670, 1000),
        ('писать', 'ru', 660, 1000),
        ('взять', 'ru', 650, 1000),
        ('считать', 'ru', 640, 1000),
        ('спросить', 'ru', 630, 1000),
        ('показать', 'ru', 620, 1000),
        ('казаться', 'ru', 610, 1000),
        ('помнить', 'ru', 600, 1000),
        ('любить', 'ru', 590, 1000),
        ('сидеть', 'ru', 580, 1000),
        ('пойти', 'ru', 570, 1000),
        ('понять', 'ru', 560, 1000),
        ('читать', 'ru', 550, 1000),
        ('оставаться', 'ru', 540, 1000),
        ('ждать', 'ru', 530, 1000),
        ('стоять', 'ru', 520, 1000),
        ('жить', 'ru', 510, 1000),
        ('начать', 'ru', 500, 1000),
        ('продолжать', 'ru', 490, 1000),
        ('держать', 'ru', 480, 1000),
        ('играть', 'ru', 470, 1000),
        ('называть', 'ru', 460, 1000),
        ('решить', 'ru', 450, 1000),
        ('перестать', 'ru', 440, 1000),
        ('слышать', 'ru', 430, 1000),
        ('прийти', 'ru', 420, 1000),
        ('открыть', 'ru', 410, 1000),
        ('принять', 'ru', 400, 1000),
        ('считать', 'ru', 390, 1000),
        ('встретить', 'ru', 380, 1000),
        ('изменить', 'ru', 370, 1000),
        ('учиться', 'ru', 360, 1000),

        -- Common nouns
        ('человек', 'ru', 850, 1000),
        ('время', 'ru', 840, 1000),
        ('год', 'ru', 830, 1000),
        ('дело', 'ru', 820, 1000),
        ('жизнь', 'ru', 810, 1000),
        ('день', 'ru', 800, 1000),
        ('рука', 'ru', 790, 1000),
        ('раз', 'ru', 780, 1000),
        ('работа', 'ru', 770, 1000),
        ('слово', 'ru', 760, 1000),
        ('место', 'ru', 750, 1000),
        ('лицо', 'ru', 740, 1000),
        ('друг', 'ru', 730, 1000),
        ('глаз', 'ru', 720, 1000),
        ('вопрос', 'ru', 710, 1000),
        ('дом', 'ru', 700, 1000),
        ('сторона', 'ru', 690, 1000),
        ('страна', 'ru', 680, 1000),
        ('мир', 'ru', 670, 1000),
        ('случай', 'ru', 660, 1000),
        ('голова', 'ru', 650, 1000),
        ('ребенок', 'ru', 640, 1000),
        ('сила', 'ru', 630, 1000),
        ('конец', 'ru', 620, 1000),
        ('город', 'ru', 610, 1000),
        ('часть', 'ru', 600, 1000),
        ('вид', 'ru', 590, 1000),
        ('женщина', 'ru', 580, 1000),
        ('система', 'ru', 570, 1000),
        ('путь', 'ru', 560, 1000),
        ('час', 'ru', 550, 1000),
        ('имя', 'ru', 540, 1000),
        ('минута', 'ru', 530, 1000),
        ('отец', 'ru', 520, 1000),
        ('мать', 'ru', 510, 1000),
        ('комната', 'ru', 500, 1000),
        ('товарищ', 'ru', 490, 1000),
        ('вечер', 'ru', 480, 1000),
        ('взгляд', 'ru', 470, 1000),
        ('утро', 'ru', 460, 1000),
        ('государство', 'ru', 450, 1000),
        ('народ', 'ru', 440, 1000),
        ('семья', 'ru', 430, 1000),
        ('образ', 'ru', 420, 1000),
        ('история', 'ru', 410, 1000),
        ('власть', 'ru', 400, 1000),
        ('форма', 'ru', 390, 1000),
        ('школа', 'ru', 380, 1000),
        ('земля', 'ru', 370, 1000),
        ('война', 'ru', 360, 1000),

        -- Common adjectives
        ('новый', 'ru', 850, 1000),
        ('большой', 'ru', 840, 1000),
        ('первый', 'ru', 830, 1000),
        ('последний', 'ru', 820, 1000),
        ('хороший', 'ru', 810, 1000),
        ('главный', 'ru', 800, 1000),
        ('старый', 'ru', 790, 1000),
        ('маленький', 'ru', 780, 1000),
        ('другой', 'ru', 770, 1000),
        ('молодой', 'ru', 760, 1000),
        ('русский', 'ru', 750, 1000),
        ('общий', 'ru', 740, 1000),
        ('белый', 'ru', 730, 1000),
        ('черный', 'ru', 720, 1000),
        ('целый', 'ru', 710, 1000),
        ('важный', 'ru', 700, 1000),
        ('длинный', 'ru', 690, 1000),
        ('высокий', 'ru', 680, 1000),
        ('простой', 'ru', 670, 1000),
        ('сильный', 'ru', 660, 1000),
        ('военный', 'ru', 650, 1000),
        ('свободный', 'ru', 640, 1000),
        ('нужный', 'ru', 630, 1000),
        ('полный', 'ru', 620, 1000),
        ('трудный', 'ru', 610, 1000),
        ('истинный', 'ru', 600, 1000),
        ('возможный', 'ru', 590, 1000),
        ('политический', 'ru', 580, 1000),
        ('социальный', 'ru', 570, 1000),
        ('народный', 'ru', 560, 1000),
        ('различный', 'ru', 550, 1000),
        ('естественный', 'ru', 540, 1000),
        ('настоящий', 'ru', 530, 1000),
        ('глубокий', 'ru', 520, 1000),
        ('широкий', 'ru', 510, 1000),
        ('особый', 'ru', 500, 1000),
        ('живой', 'ru', 490, 1000),
        ('единый', 'ru', 480, 1000),
        ('прошлый', 'ru', 470, 1000),
        ('красный', 'ru', 460, 1000),
        ('ясный', 'ru', 450, 1000),
        ('близкий', 'ru', 440, 1000),
        ('известный', 'ru', 430, 1000),
        ('холодный', 'ru', 420, 1000),
        ('легкий', 'ru', 410, 1000),
        ('прямой', 'ru', 400, 1000),
        ('тяжелый', 'ru', 390, 1000),
        ('короткий', 'ru', 380, 1000),
        ('далекий', 'ru', 370, 1000),
        ('быстрый', 'ru', 360, 1000),

        -- Common adverbs
        ('очень', 'ru', 850, 1000),
        ('уже', 'ru', 840, 1000),
        ('еще', 'ru', 830, 1000),
        ('только', 'ru', 820, 1000),
        ('теперь', 'ru', 810, 1000),
        ('также', 'ru', 800, 1000),
        ('даже', 'ru', 790, 1000),
        ('всегда', 'ru', 780, 1000),
        ('сейчас', 'ru', 770, 1000),
        ('просто', 'ru', 760, 1000),
        ('совсем', 'ru', 750, 1000),
        ('потом', 'ru', 740, 1000),
        ('может', 'ru', 730, 1000),
        ('именно', 'ru', 720, 1000),
        ('снова', 'ru', 710, 1000),
        ('особенно', 'ru', 700, 1000),
        ('тоже', 'ru', 690, 1000),
        ('вместе', 'ru', 680, 1000),
        ('никогда', 'ru', 670, 1000),
        ('конечно', 'ru', 660, 1000),
        ('больше', 'ru', 650, 1000),
        ('видимо', 'ru', 640, 1000),
        ('наконец', 'ru', 630, 1000),
        ('поэтому', 'ru', 620, 1000),
        ('вообще', 'ru', 610, 1000),
        ('вдруг', 'ru', 600, 1000),
        ('слишком', 'ru', 590, 1000),
        ('совершенно', 'ru', 580, 1000),
        ('действительно', 'ru', 570, 1000),
        ('обязательно', 'ru', 560, 1000),
        ('впрочем', 'ru', 550, 1000),
        ('постоянно', 'ru', 540, 1000),
        ('обычно', 'ru', 530, 1000),
        ('немедленно', 'ru', 520, 1000),
        ('непосредственно', 'ru', 510, 1000),
        ('довольно', 'ru', 500, 1000),
        ('впервые', 'ru', 490, 1000),
        ('главным', 'ru', 480, 1000),
        ('прямо', 'ru', 470, 1000),
        ('скоро', 'ru', 460, 1000),
        ('часто', 'ru', 450, 1000),
        ('вероятно', 'ru', 440, 1000),
        ('наверное', 'ru', 430, 1000),
        ('недавно', 'ru', 420, 1000),
        ('например', 'ru', 410, 1000),
        ('точно', 'ru', 400, 1000),
        ('полностью', 'ru', 390, 1000),
        ('абсолютно', 'ru', 380, 1000),
        ('практически', 'ru', 370, 1000),
        ('исключительно', 'ru', 360, 1000)
    """)


def downgrade():
    # Remove tables in reverse order
    op.drop_table('keyword_training_data')
    op.drop_table('user_corpus_stats')
    op.drop_table('global_corpus_stats')
    op.drop_table('keyword_extraction_config')
